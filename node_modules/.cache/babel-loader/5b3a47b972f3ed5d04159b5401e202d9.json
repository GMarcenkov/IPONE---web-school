{"ast":null,"code":"var _jsxFileName = \"/home/george/Documents/Home/ipon-web-school/src/client/admin/modules/products/productEdit/ProductEditContainer.js\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport \"../productCreate/components/ProductCreate.css\";\nimport slugify from \"slugify\";\nimport Select from \"react-select\";\nimport { CustomOption } from \"../../category/components/CategoryCreate/CustomOption\";\nimport { selectCategory } from \"../../category/components/CategoryCreate/SelectCategory\";\n\nclass ProductEditContainer extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleInput = event => {\n      this.setState({ ...this.state,\n        [event.target.name]: event.target.value\n      });\n    };\n\n    this.handleChangeParent = parent => {\n      this.setState({\n        category_title: parent.label\n      });\n    };\n\n    this.handleGetProductById = async () => {\n      await axios.get(`http://localhost:5000/products/${this.state.editedProductId}`).then(response => {\n        console.log(response.data);\n        this.setState({\n          title: response.data.title,\n          imageLink: response.data.imageLink,\n          price: response.data.price,\n          discount_price: response.data.discount_price,\n          weight: response.data.weight,\n          sku: response.data.sku,\n          quantity: response.data.quantity\n        });\n      }).catch(function (error) {});\n    };\n\n    this.handleGetCategory = async () => {\n      await axios.get(\"http://localhost:5000/category/\").then(response => {\n        response.data.map(category => {\n          this.handleBuildCategory(category, response.data);\n        });\n        this.state.subcategories.map(sub => {\n          if (!sub.parent_id) {\n            this.state.categories.push(sub);\n          }\n        });\n        this.setState({\n          isLoading: false\n        });\n      }).catch(function (error) {});\n    };\n\n    this.handleBuildCategory = (category, categories) => {\n      let result = categories.filter(sub => sub.parent_id === category._id);\n\n      if (result.length > 0) {\n        category.subcategory = result;\n        this.state.subcategories.push(category);\n      } else {\n        if (!category.parent_id) {\n          this.state.subcategories.push(category);\n        }\n      }\n    };\n\n    this.validateForm = data => {\n      const error = {};\n\n      if (data.title.length < 3) {\n        error.title = \"Името е твърде късо.\";\n      }\n\n      if (data.price < 1) {\n        error.price = \"Липсва цена.\";\n      }\n\n      if (data.category_title.length < 3) {\n        error.category = \"Изберете категория.\";\n      }\n\n      if (data.weight < 1) {\n        error.weight = \"Добавете тегло.\";\n      }\n\n      if (data.sku < 1) {\n        error.sku = \"Добавете SKU.\";\n      }\n\n      if (data.quantity < 1) {\n        error.quantity = \"Добавете бройка.\";\n      }\n\n      if (data.imageLink < 1) {\n        error.imageLink = \"Добавете снимка.\";\n      }\n\n      return error;\n    };\n\n    this.handleSubmit = () => {\n      const {\n        title,\n        price,\n        discount_price,\n        weight,\n        category_title,\n        sku,\n        quantity,\n        imageLink\n      } = this.state;\n      const errors = this.validateForm(this.state);\n      const isValid = Object.values(errors).filter(Boolean).length <= 0;\n\n      if (!isValid) {\n        this.setState({\n          errors: errors\n        });\n        return;\n      }\n\n      this.setState({\n        request: \"\"\n      });\n      const product = {\n        title: title,\n        price: price * 100,\n        discount_price: discount_price * 100,\n        weight: weight * 1000,\n        category: category_title,\n        category_slug: slugify(category_title, {\n          lower: true,\n          remove: /[():.@><,_{}]/g\n        }),\n        sku: sku,\n        quantity: quantity,\n        imageLink: imageLink,\n        slug: slugify(title, {\n          lower: true,\n          remove: /[():.@><,_{}]/g\n        })\n      };\n      axios.put(`http://localhost:5000/products/update/${this.state.editedProductId}`, product).then(res => {\n        this.setState({\n          title: \"\",\n          price: 0,\n          discount_price: 0,\n          category_title: \"\",\n          weight: 0,\n          sku: 0,\n          quantity: 0\n        });\n        window.location.href = \"/admincp/products\";\n      }).catch(error => this.setState({\n        error: \"Името или SKU на пеодукта е вече използвано.\"\n      }));\n    };\n\n    this.state = {\n      title: \"\",\n      imageLink: \"\",\n      category_title: \"\",\n      price: 0,\n      discount_price: 0,\n      categories: [],\n      subcategories: [{\n        parent_id: ''\n      }],\n      weight: 0,\n      sku: 0,\n      editedProductId: this.props.editedProductId,\n      isLoading: true,\n      quantity: 0,\n      errors: {},\n      error: \"\"\n    };\n  }\n\n  componentDidMount() {\n    this.handleGetProductById();\n    this.handleGetCategory();\n  }\n\n  render() {\n    const {\n      title,\n      price,\n      discount_price,\n      weight,\n      categories,\n      sku,\n      quantity,\n      imageLink,\n      errors\n    } = this.state;\n    return React.createElement(\"div\", {\n      className: \"create_product\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, \" \", React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, \"\\u0421\\u043D\\u0438\\u043C\\u043A\\u0430 \\u043D\\u0430 \\u043F\\u0440\\u043E\\u0434\\u0443\\u043A\\u0442\\u0430\"), React.createElement(\"input\", {\n      className: \"create_title\",\n      name: \"imageLink\",\n      type: \"text\",\n      onChange: this.handleInput,\n      value: imageLink,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }), imageLink === \"\" ? \"\" : React.createElement(\"img\", {\n      style: {\n        maxHeight: \"400\",\n        maxWidth: \"500px\"\n      },\n      src: imageLink,\n      alt: \"product\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, errors.imageLink ? React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, errors.imageLink) : \"\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, \" \", React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    }, \"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F\"), React.createElement(\"div\", {\n      style: {\n        \"max-width\": \"680px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, React.createElement(Select, {\n      onChange: id => this.handleChangeParent(id),\n      defaultValue: {\n        label: \"Родител...\",\n        value: \"\"\n      },\n      style: {\n        cursor: \"pointer\"\n      },\n      components: {\n        Option: CustomOption\n      },\n      options: categories.map(option => {\n        return selectCategory(option);\n      }).flat(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231\n      },\n      __self: this\n    }, errors.title ? errors.title : \"\")), React.createElement(\"div\", {\n      className: \"form_row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, \" \", React.createElement(\"div\", {\n      className: \"form_body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237\n      },\n      __self: this\n    }, \"\\u0426\\u0435\\u043D\\u0430\"), React.createElement(\"input\", {\n      className: \"form_input\",\n      name: \"price\",\n      type: \"number\",\n      onChange: this.handleInput,\n      value: price,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, errors.price ? errors.price : \"\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249\n      },\n      __self: this\n    }, \" \", React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    }, \"\\u0421\\u043F\\u0435\\u0446\\u0438\\u0430\\u043B\\u043D\\u0430 \\u0446\\u0435\\u043D\\u0430\"), React.createElement(\"input\", {\n      className: \"form_input\",\n      name: \"discount_price\",\n      type: \"number\",\n      onChange: this.handleInput,\n      value: discount_price,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, errors.discount_price ? errors.discount_price : \"\")))), React.createElement(\"div\", {\n      className: \"form_row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form_body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268\n      },\n      __self: this\n    }, \"\\u0422\\u0435\\u0433\\u043B\\u043E \\u0432 \\u043A\\u0438\\u043B\\u043E\\u0433\\u0440\\u0430\\u043C\\u0438\"), React.createElement(\"input\", {\n      className: \"form_input\",\n      name: \"weight\",\n      type: \"number\",\n      onChange: this.handleInput,\n      value: weight,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276\n      },\n      __self: this\n    }, errors.weight ? errors.weight : \"\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }, \"\\u0417\\u0430\\u0433\\u043B\\u0430\\u0432\\u0438\\u0435\"), React.createElement(\"input\", {\n      className: \"form_input\",\n      name: \"title\",\n      type: \"text\",\n      onChange: this.handleInput,\n      value: title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }, errors.category ? errors.category : \"\")))), React.createElement(\"div\", {\n      className: \"form_row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form_body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298\n      },\n      __self: this\n    }, \"SKU\"), React.createElement(\"input\", {\n      className: \"form_input\",\n      name: \"sku\",\n      type: \"number\",\n      onChange: this.handleInput,\n      value: sku,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306\n      },\n      __self: this\n    }, errors.sku ? errors.sku : \"\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309\n      },\n      __self: this\n    }, \"\\u0411\\u0440\\u043E\\u0439\\u043A\\u0430\"), React.createElement(\"input\", {\n      className: \"form_input\",\n      placeholder: \"\\u0411\\u0440\\u043E\\u0439\\u043A\\u0430\",\n      name: \"quantity\",\n      type: \"number\",\n      onChange: this.handleInput,\n      value: quantity,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    }, errors.quantity ? errors.quantity : \"\")))), React.createElement(\"button\", {\n      className: \"create_button\",\n      onClick: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324\n      },\n      __self: this\n    }, \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u0430\\u0439\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }, this.state.error));\n  }\n\n}\n\nexport default ProductEditContainer;","map":{"version":3,"sources":["/home/george/Documents/Home/ipon-web-school/src/client/admin/modules/products/productEdit/ProductEditContainer.js"],"names":["React","axios","slugify","Select","CustomOption","selectCategory","ProductEditContainer","Component","constructor","props","handleInput","event","setState","state","target","name","value","handleChangeParent","parent","category_title","label","handleGetProductById","get","editedProductId","then","response","console","log","data","title","imageLink","price","discount_price","weight","sku","quantity","catch","error","handleGetCategory","map","category","handleBuildCategory","subcategories","sub","parent_id","categories","push","isLoading","result","filter","_id","length","subcategory","validateForm","handleSubmit","errors","isValid","Object","values","Boolean","request","product","category_slug","lower","remove","slug","put","res","window","location","href","componentDidMount","render","maxHeight","maxWidth","color","id","cursor","Option","option","flat"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\nimport \"../productCreate/components/ProductCreate.css\";\nimport slugify from \"slugify\";\nimport Select from \"react-select\";\nimport { CustomOption } from \"../../category/components/CategoryCreate/CustomOption\";\nimport { selectCategory } from \"../../category/components/CategoryCreate/SelectCategory\";\n\nclass ProductEditContainer extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      title: \"\",\n      imageLink: \"\",\n      category_title: \"\",\n      price: 0,\n      discount_price: 0,\n      categories: [],\n      subcategories: [{parent_id:''}],\n      weight: 0,\n      sku: 0,\n      editedProductId: this.props.editedProductId,\n      isLoading: true,\n      quantity: 0,\n      errors: {},\n      error: \"\"\n    };\n  }\n\n  componentDidMount() {\n    this.handleGetProductById();\n    this.handleGetCategory();\n  }\n\n  handleInput = event => {\n    this.setState({\n      ...this.state,\n      [event.target.name]: event.target.value\n    });\n  };\n\n  handleChangeParent = parent => {\n    this.setState({ category_title: parent.label });\n  };\n\n  handleGetProductById = async () => {\n    await axios\n      .get(`http://localhost:5000/products/${this.state.editedProductId}`)\n      .then(response => {\n        console.log(response.data);\n        this.setState({\n          title: response.data.title,\n          imageLink: response.data.imageLink,\n          price: response.data.price,\n          discount_price: response.data.discount_price,\n          weight: response.data.weight,\n          sku: response.data.sku,\n          quantity: response.data.quantity\n        });\n      })\n      .catch(function(error) {});\n  };\n\n  handleGetCategory = async () => {\n    await axios\n      .get(\"http://localhost:5000/category/\")\n      .then(response => {\n        response.data.map(category => {\n          this.handleBuildCategory(category, response.data);\n        });\n        this.state.subcategories.map(sub => {\n          if (!sub.parent_id) {\n            this.state.categories.push(sub);\n          }\n        });\n        this.setState({ isLoading: false });\n      })\n      .catch(function(error) {});\n  };\n  handleBuildCategory = (category, categories) => {\n    let result = categories.filter(sub => sub.parent_id === category._id);\n\n    if (result.length > 0) {\n      category.subcategory = result;\n      this.state.subcategories.push(category);\n    } else {\n      if (!category.parent_id) {\n        this.state.subcategories.push(category);\n      }\n    }\n  };\n  validateForm = data => {\n    const error = {};\n\n    if (data.title.length < 3) {\n      error.title = \"Името е твърде късо.\";\n    }\n    if (data.price < 1) {\n      error.price = \"Липсва цена.\";\n    }\n    if (data.category_title.length < 3) {\n      error.category = \"Изберете категория.\";\n    }\n    if (data.weight < 1) {\n      error.weight = \"Добавете тегло.\";\n    }\n    if (data.sku < 1) {\n      error.sku = \"Добавете SKU.\";\n    }\n    if (data.quantity < 1) {\n      error.quantity = \"Добавете бройка.\";\n    }\n    if (data.imageLink < 1) {\n      error.imageLink = \"Добавете снимка.\";\n    }\n    return error;\n  };\n  handleSubmit = () => {\n    const {\n      title,\n      price,\n      discount_price,\n      weight,\n      category_title,\n      sku,\n      quantity,\n      imageLink\n    } = this.state;\n    const errors = this.validateForm(this.state);\n    const isValid = Object.values(errors).filter(Boolean).length <= 0;\n    if (!isValid) {\n      this.setState({ errors: errors });\n      return;\n    }\n    this.setState({ request: \"\" });\n    const product = {\n      title: title,\n      price: price * 100,\n      discount_price: discount_price * 100,\n      weight: weight * 1000,\n      category: category_title,\n      category_slug:slugify(category_title, { lower: true, remove: /[():.@><,_{}]/g }),\n      sku: sku,\n      quantity: quantity,\n      imageLink: imageLink,\n      slug: slugify(title, { lower: true, remove: /[():.@><,_{}]/g })\n    };\n    axios\n      .put(\n        `http://localhost:5000/products/update/${this.state.editedProductId}`,\n        product\n      )\n      .then(res => {\n        this.setState({\n          title: \"\",\n          price: 0,\n          discount_price: 0,\n          category_title:\"\",\n          weight: 0,\n          sku: 0,\n          quantity: 0\n        });\n        window.location.href = \"/admincp/products\";\n      })\n      .catch(error =>\n        this.setState({ error: \"Името или SKU на пеодукта е вече използвано.\" })\n      );\n  };\n  render() {\n    const {\n      title,\n      price,\n      discount_price,\n      weight,\n      categories,\n      sku,\n      quantity,\n      imageLink,\n      errors\n    } = this.state;\n    return (\n      <div className=\"create_product\">\n        <div>\n          {\" \"}\n          <div>Снимка на продукта</div>\n          <input\n            className=\"create_title\"\n            name=\"imageLink\"\n            type=\"text\"\n            onChange={this.handleInput}\n            value={imageLink}\n          />\n          {imageLink === \"\" ? (\n            \"\"\n          ) : (\n            <img\n              style={{ maxHeight: \"400\", maxWidth: \"500px\" }}\n              src={imageLink}\n              alt=\"product\"\n            />\n          )}\n          <div>\n            {errors.imageLink ? (\n              <div style={{ color: \"red\" }}>{errors.imageLink}</div>\n            ) : (\n              \"\"\n            )}\n          </div>\n        </div>\n\n        <div>\n          {\" \"}\n          <div>Категория</div>\n          <div style={{ \"max-width\": \"680px\" }}>\n            <Select\n              onChange={id => this.handleChangeParent(id)}\n              defaultValue={{\n                label: \"Родител...\",\n                value: \"\"\n              }}\n              style={{ cursor: \"pointer\" }}\n              components={{ Option: CustomOption }}\n              options={categories\n                .map(option => {\n                  return selectCategory(option);\n                })\n                .flat()}\n            />\n          </div>\n          <div style={{ color: \"red\" }}>{errors.title ? errors.title : \"\"}</div>\n        </div>\n        <div className=\"form_row\">\n          <div className=\"row\">\n            {\" \"}\n            <div className=\"form_body\">\n              <div>Цена</div>\n              <input\n                className=\"form_input\"\n                name=\"price\"\n                type=\"number\"\n                onChange={this.handleInput}\n                value={price}\n              />\n              <div style={{ color: \"red\" }}>\n                {errors.price ? errors.price : \"\"}\n              </div>\n            </div>\n            <div>\n              {\" \"}\n              <div>Специална цена</div>\n              <input\n                className=\"form_input\"\n                name=\"discount_price\"\n                type=\"number\"\n                onChange={this.handleInput}\n                value={discount_price}\n              />\n              <div style={{ color: \"red\" }}>\n                {errors.discount_price ? errors.discount_price : \"\"}\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className=\"form_row\">\n          <div className=\"row\">\n            <div className=\"form_body\">\n              <div>Тегло в килограми</div>\n              <input\n                className=\"form_input\"\n                name=\"weight\"\n                type=\"number\"\n                onChange={this.handleInput}\n                value={weight}\n              />\n              <div style={{ color: \"red\" }}>\n                {errors.weight ? errors.weight : \"\"}\n              </div>\n            </div>\n            <div>\n              <div>Заглавие</div>\n              <input\n                className=\"form_input\"\n                name=\"title\"\n                type=\"text\"\n                onChange={this.handleInput}\n                value={title}\n              />\n              <div style={{ color: \"red\" }}>\n                {errors.category ? errors.category : \"\"}\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className=\"form_row\">\n          <div className=\"row\">\n            <div className=\"form_body\">\n              <div>SKU</div>\n              <input\n                className=\"form_input\"\n                name=\"sku\"\n                type=\"number\"\n                onChange={this.handleInput}\n                value={sku}\n              />\n              <div style={{ color: \"red\" }}>{errors.sku ? errors.sku : \"\"}</div>\n            </div>\n            <div>\n              <div>Бройка</div>\n              <input\n                className=\"form_input\"\n                placeholder=\"Бройка\"\n                name=\"quantity\"\n                type=\"number\"\n                onChange={this.handleInput}\n                value={quantity}\n              />\n              <div style={{ color: \"red\" }}>\n                {errors.quantity ? errors.quantity : \"\"}\n              </div>\n            </div>\n          </div>\n        </div>\n        <button className=\"create_button\" onClick={this.handleSubmit}>\n          Редактирай\n        </button>\n        <div>{this.state.error}</div>\n      </div>\n    );\n  }\n}\n\nexport default ProductEditContainer;\n"]},"metadata":{},"sourceType":"module"}