{"ast":null,"code":"var _jsxFileName = \"/home/george/Documents/Home/ipon-web-school/src/client/admin/modules/gradess/yearCreate/YearCreateContainer.js\";\nimport React from \"react\";\nimport YearCreate from \"./components/YearCreate.module.css\";\nimport Year from \"./components/year/Year\";\nimport axios from \"axios\";\nimport CreateGradeContainer from \"./components/CreateGradeContainer\";\nimport GradeListContainer from \"./components/GradeListContainer\";\n\nclass YearCreateContainer extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleInput = event => {\n      this.setState({ ...this.state,\n        [event.target.name]: event.target.value\n      });\n    };\n\n    this.handleGetUsers = async () => {\n      await axios.get(\"http://localhost:5000/users/\").then(response => {\n        this.setState({\n          users: response.data\n        });\n      }).catch(function (error) {});\n    };\n\n    this.handleSearch = event => {\n      this.setState({ ...this.state,\n        [event.target.name]: event.target.value\n      });\n      let students = [];\n\n      if (event.target.value.trim().length === 0) {\n        this.setState({\n          search: []\n        });\n      } else {\n        this.state.users.map(user => {\n          if (this.state.filterByName) {\n            if (user.name.includes(event.target.value) || user.secondName.includes(event.target.value) || user.familyName.includes(event.target.value)) {\n              students.push(user);\n            }\n          } else {\n            if (user.username.includes(event.target.value.trim())) {\n              students.push(user);\n            }\n          }\n        });\n        this.setState({\n          search: students\n        });\n      }\n\n      students = [];\n    };\n\n    this.handleChangeFilter = () => {\n      if (this.state.filterByName) {\n        this.setState({\n          filterByName: false\n        });\n      } else {\n        this.setState({\n          filterByName: true\n        });\n      }\n    };\n\n    this.handleAddStudent = student => {\n      let stu = [];\n      this.state.students.push(student);\n      this.state.students.map(student => {\n        stu = this.state.users.filter(user => user._id !== student._id);\n      });\n      this.setState({\n        search: [],\n        users: stu,\n        addStudent: \"\"\n      });\n    };\n\n    this.handleCreateGrade = () => {\n      const {\n        teacher,\n        grade,\n        subGrade,\n        students,\n        schoolYear\n      } = this.state;\n      let NewGrade = {\n        grade: parseInt(grade),\n        teacher: teacher,\n        subGrade: subGrade,\n        students: students\n      };\n      let filterJuniorSchool = schoolYear.juniorSchool.filter(grade => grade.subGrade === NewGrade.subGrade && grade.grade === NewGrade.grade);\n      let filterInterSchool = schoolYear.interSchool.filter(grade => grade.subGrade === NewGrade.subGrade && grade.grade === NewGrade.grade);\n      let filterHighSchool = schoolYear.highSchool.filter(grade => grade.subGrade === NewGrade.subGrade && grade.grade === NewGrade.grade);\n\n      if (parseInt(grade) > 0 && parseInt(grade) < 5) {\n        if (filterJuniorSchool.length === 0) {\n          schoolYear.juniorSchool.push(NewGrade);\n          this.setState({\n            students: [],\n            teacher: \"\",\n            grade: 1,\n            subGrade: \"a\"\n          });\n        }\n      }\n\n      if (parseInt(grade) > 4 && parseInt(grade) < 8) {\n        if (filterInterSchool.length === 0) {\n          schoolYear.interSchool.push(NewGrade);\n          this.setState({\n            students: [],\n            teacher: \"\",\n            grade: 1,\n            subGrade: \"a\"\n          });\n        }\n      }\n\n      if (parseInt(grade) > 7 && parseInt(grade) < 13) {\n        if (filterHighSchool.length === 0) {\n          schoolYear.highSchool.push(NewGrade);\n          this.setState({\n            students: [],\n            teacher: \"\",\n            grade: 1,\n            subGrade: \"a\"\n          });\n        }\n      }\n\n      this.setState({});\n      localStorage.setItem(\"schoolYear\", JSON.stringify(this.state.schoolYear));\n      console.log(this.state.schoolYear);\n    };\n\n    this.handleDeleteStudent = id => {\n      const {\n        students\n      } = this.state;\n      let newStudents = students.filter(stu => stu._id !== id);\n      this.setState({\n        students: newStudents\n      });\n    };\n\n    this.handleDeleteGrade = (grade, subGrade) => {\n      console.log(grade, subGrade);\n      const {\n        schoolYear\n      } = this.state;\n\n      if (parseInt(grade) > 0 && parseInt(grade) < 5) {\n        let newGrade = schoolYear.juniorSchool.filter(grd => grd.grade !== grade && grd.subGrade !== subGrade);\n        this.setState({\n          schoolYear: { ...this.state.schoolYear,\n            juniorSchool: newGrade\n          }\n        });\n      } // if (parseInt(grade) > 4 && parseInt(grade) < 8) {\n      //   let newGrade = students.filter(stu => stu._id !== id);\n      // }\n      // if (parseInt(grade) > 7 && parseInt(grade) < 13) {\n      //   let newGrade = students.filter(stu => stu._id !== id);\n      // }\n\n    };\n\n    this.handleTakeGrade = (grade, subGrade) => {\n      const {\n        schoolYear\n      } = this.state;\n\n      if (parseInt(grade) > 0 && parseInt(grade) < 5) {\n        let newGrade = schoolYear.juniorSchool.filter(grd => grd.grade === grade && grd.subGrade === subGrade);\n        this.setState({\n          students: newGrade[0].students,\n          teacher: newGrade[0].teacher,\n          grade: newGrade[0].grade,\n          subGrade: newGrade[0].subGrade,\n          editModel: true\n        });\n      }\n\n      if (parseInt(grade) > 4 && parseInt(grade) < 8) {\n        let newGrade = schoolYear.interSchool.filter(grd => grd.grade === grade && grd.subGrade === subGrade);\n        this.setState({\n          students: newGrade[0].students,\n          teacher: newGrade[0].teacher,\n          grade: newGrade[0].grade,\n          subGrade: newGrade[0].subGrade,\n          editModel: true\n        });\n      }\n\n      if (parseInt(grade) > 7 && parseInt(grade) < 13) {\n        let newGrade = schoolYear.highSchool.filter(grd => grd.grade === grade && grd.subGrade === subGrade);\n        this.setState({\n          students: newGrade[0].students,\n          teacher: newGrade[0].teacher,\n          grade: newGrade[0].grade,\n          subGrade: newGrade[0].subGrade,\n          editModel: true\n        });\n      }\n    };\n\n    this.handleEditGrade = () => {\n      const {\n        teacher,\n        grade,\n        subGrade,\n        students,\n        schoolYear,\n        editModel\n      } = this.state;\n      let newGrade = {\n        grade: grade,\n        subGrade: subGrade,\n        teacher: teacher,\n        students: students\n      };\n\n      if (parseInt(grade) > 0 && parseInt(grade) < 5) {\n        let grades = schoolYear.juniorSchool.filter(grd => grd.grade !== grade);\n        console.log(grades);\n      }\n\n      if (parseInt(grade) > 4 && parseInt(grade) < 8) {\n        let newGrade = schoolYear.interSchool.filter(grd => grd.grade === grade && grd.subGrade === subGrade);\n      }\n\n      if (parseInt(grade) > 7 && parseInt(grade) < 13) {\n        let newGrade = schoolYear.highSchool.filter(grd => grd.grade === grade && grd.subGrade === subGrade);\n      }\n    };\n\n    this.state = {\n      editModel: false,\n      yearFrom: null,\n      yearTo: null,\n      grade: 1,\n      subGrade: \"a\",\n      teacher: \"\",\n      students: [],\n      users: [],\n      addStudent: \"\",\n      filterByName: false,\n      search: [],\n      schoolYear: {\n        yearFrom: 2019,\n        yearTo: 2020,\n        juniorSchool: [],\n        interSchool: [],\n        highSchool: []\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.handleGetUsers();\n  }\n\n  render() {\n    const {\n      yearFrom,\n      yearTo,\n      teacher,\n      grade,\n      subGrade,\n      students,\n      users,\n      addStudent,\n      filterByName,\n      search,\n      schoolYear,\n      editModel\n    } = this.state;\n    return React.createElement(\"div\", {\n      className: YearCreate.year_container,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: YearCreate.year_title_border,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: YearCreate.year_create_title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268\n      },\n      __self: this\n    }, \"\\u0421\\u044A\\u0437\\u0434\\u0430\\u0432\\u0430\\u043D\\u0435 \\u043D\\u0430 \\u0443\\u0447\\u0435\\u0431\\u043D\\u0430 \\u0433\\u043E\\u0434\\u0438\\u043D\\u0430\"), React.createElement(Year, {\n      yearFrom: yearFrom,\n      yearTo: yearTo,\n      handleInput: this.handleInput,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: YearCreate.year_holder,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }, React.createElement(GradeListContainer, {\n      schoolYear: schoolYear,\n      handleEditGrade: this.handleTakeGrade,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }), React.createElement(CreateGradeContainer, {\n      handleCreateGrade: this.handleCreateGrade,\n      yearFrom: yearFrom,\n      editModel: editModel,\n      yearTo: yearTo,\n      teacher: teacher,\n      grade: grade,\n      subGrade: subGrade,\n      students: students,\n      users: users,\n      addStudent: addStudent,\n      filterByName: filterByName,\n      search: search,\n      handleEditGrade: this.handleEditGrade,\n      handleDeleteStudent: this.handleDeleteStudent,\n      handleInput: this.handleInput,\n      handleAddStudent: this.handleAddStudent,\n      handleChangeFilter: this.handleChangeFilter,\n      handleSearch: this.handleSearch,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282\n      },\n      __self: this\n    })));\n  }\n\n}\n\nYearCreateContainer.propTypes = {};\nexport default YearCreateContainer;","map":{"version":3,"sources":["/home/george/Documents/Home/ipon-web-school/src/client/admin/modules/gradess/yearCreate/YearCreateContainer.js"],"names":["React","YearCreate","Year","axios","CreateGradeContainer","GradeListContainer","YearCreateContainer","Component","constructor","props","handleInput","event","setState","state","target","name","value","handleGetUsers","get","then","response","users","data","catch","error","handleSearch","students","trim","length","search","map","user","filterByName","includes","secondName","familyName","push","username","handleChangeFilter","handleAddStudent","student","stu","filter","_id","addStudent","handleCreateGrade","teacher","grade","subGrade","schoolYear","NewGrade","parseInt","filterJuniorSchool","juniorSchool","filterInterSchool","interSchool","filterHighSchool","highSchool","localStorage","setItem","JSON","stringify","console","log","handleDeleteStudent","id","newStudents","handleDeleteGrade","newGrade","grd","handleTakeGrade","editModel","handleEditGrade","grades","yearFrom","yearTo","componentDidMount","render","year_container","year_title_border","year_create_title","year_holder","propTypes"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport YearCreate from \"./components/YearCreate.module.css\";\nimport Year from \"./components/year/Year\";\nimport axios from \"axios\";\nimport CreateGradeContainer from \"./components/CreateGradeContainer\";\nimport GradeListContainer from \"./components/GradeListContainer\";\n\nclass YearCreateContainer extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      editModel:false,\n      yearFrom: null,\n      yearTo: null,\n      grade: 1,\n      subGrade: \"a\",\n      teacher: \"\",\n      students: [],\n      users: [],\n      addStudent: \"\",\n      filterByName: false,\n      search: [],\n      schoolYear: {\n        yearFrom: 2019,\n        yearTo: 2020,\n        juniorSchool: [],\n        interSchool: [],\n        highSchool: []\n      }\n    };\n  }\n  componentDidMount() {\n    this.handleGetUsers();\n  }\n\n  handleInput = event => {\n    this.setState({\n      ...this.state,\n      [event.target.name]: event.target.value\n    });\n  };\n  handleGetUsers = async () => {\n    await axios\n      .get(\"http://localhost:5000/users/\")\n      .then(response => {\n        this.setState({ users: response.data });\n      })\n      .catch(function(error) {});\n  };\n  handleSearch = event => {\n    this.setState({\n      ...this.state,\n      [event.target.name]: event.target.value\n    });\n    let students = [];\n    if (event.target.value.trim().length === 0) {\n      this.setState({ search: [] });\n    } else {\n      this.state.users.map(user => {\n        if (this.state.filterByName) {\n          if (\n            user.name.includes(event.target.value) ||\n            user.secondName.includes(event.target.value) ||\n            user.familyName.includes(event.target.value)\n          ) {\n            students.push(user);\n          }\n        } else {\n          if (user.username.includes(event.target.value.trim())) {\n            students.push(user);\n          }\n        }\n      });\n      this.setState({ search: students });\n    }\n    students = [];\n  };\n  handleChangeFilter = () => {\n    if (this.state.filterByName) {\n      this.setState({ filterByName: false });\n    } else {\n      this.setState({ filterByName: true });\n    }\n  };\n  handleAddStudent = student => {\n    let stu = [];\n    this.state.students.push(student);\n    this.state.students.map(student => {\n      stu = this.state.users.filter(user => user._id !== student._id);\n    });\n    this.setState({ search: [], users: stu, addStudent: \"\" });\n  };\n  handleCreateGrade = () => {\n    const { teacher, grade, subGrade, students, schoolYear } = this.state;\n    let NewGrade = {\n      grade: parseInt(grade),\n      teacher: teacher,\n      subGrade: subGrade,\n      students: students\n    };\n    let filterJuniorSchool = schoolYear.juniorSchool.filter(\n      grade =>\n        grade.subGrade === NewGrade.subGrade && grade.grade === NewGrade.grade\n    );\n    let filterInterSchool = schoolYear.interSchool.filter(\n      grade =>\n        grade.subGrade === NewGrade.subGrade && grade.grade === NewGrade.grade\n    );\n    let filterHighSchool = schoolYear.highSchool.filter(\n      grade =>\n        grade.subGrade === NewGrade.subGrade && grade.grade === NewGrade.grade\n    );\n    if (parseInt(grade) > 0 && parseInt(grade) < 5) {\n      if (filterJuniorSchool.length === 0) {\n        schoolYear.juniorSchool.push(NewGrade);\n        this.setState({\n          students: [],\n          teacher: \"\",\n          grade: 1,\n          subGrade: \"a\"\n        });\n      }\n    }\n    if (parseInt(grade) > 4 && parseInt(grade) < 8) {\n      if (filterInterSchool.length === 0) {\n        schoolYear.interSchool.push(NewGrade);\n        this.setState({\n          students: [],\n          teacher: \"\",\n          grade: 1,\n          subGrade: \"a\"\n        });\n      }\n    }\n    if (parseInt(grade) > 7 && parseInt(grade) < 13) {\n      if (filterHighSchool.length === 0) {\n        schoolYear.highSchool.push(NewGrade);\n        this.setState({\n          students: [],\n          teacher: \"\",\n          grade: 1,\n          subGrade: \"a\"\n        });\n      }\n    }\n    this.setState({});\n    localStorage.setItem(\"schoolYear\", JSON.stringify(this.state.schoolYear));\n    console.log(this.state.schoolYear);\n  };\n  handleDeleteStudent = id => {\n    const { students } = this.state;\n    let newStudents = students.filter(stu => stu._id !== id);\n    this.setState({ students: newStudents });\n  };\n  handleDeleteGrade = (grade, subGrade) => {\n    console.log(grade, subGrade);\n    const { schoolYear } = this.state;\n\n    if (parseInt(grade) > 0 && parseInt(grade) < 5) {\n      let newGrade = schoolYear.juniorSchool.filter(\n        grd => grd.grade !== grade && grd.subGrade !== subGrade\n      );\n      this.setState({\n        schoolYear: { ...this.state.schoolYear, juniorSchool: newGrade }\n      });\n    }\n    // if (parseInt(grade) > 4 && parseInt(grade) < 8) {\n    //   let newGrade = students.filter(stu => stu._id !== id);\n    // }\n    // if (parseInt(grade) > 7 && parseInt(grade) < 13) {\n    //   let newGrade = students.filter(stu => stu._id !== id);\n    // }\n  };\n  handleTakeGrade = (grade, subGrade) => {\n    const { schoolYear } = this.state;\n\n    if (parseInt(grade) > 0 && parseInt(grade) < 5) {\n      let newGrade = schoolYear.juniorSchool.filter(\n        grd => grd.grade === grade && grd.subGrade === subGrade\n      );\n      this.setState({\n        students: newGrade[0].students,\n        teacher: newGrade[0].teacher,\n        grade: newGrade[0].grade,\n        subGrade: newGrade[0].subGrade,\n        editModel:true\n      });\n    }\n    if (parseInt(grade) > 4 && parseInt(grade) < 8) {\n      let newGrade = schoolYear.interSchool.filter(\n        grd => grd.grade === grade && grd.subGrade === subGrade\n      );\n      this.setState({\n        students: newGrade[0].students,\n        teacher: newGrade[0].teacher,\n        grade: newGrade[0].grade,\n        subGrade: newGrade[0].subGrade,\n        editModel:true\n      });\n    }\n    if (parseInt(grade) > 7 && parseInt(grade) < 13) {\n      let newGrade = schoolYear.highSchool.filter(\n        grd => grd.grade === grade && grd.subGrade === subGrade\n      );\n      this.setState({\n        students: newGrade[0].students,\n        teacher: newGrade[0].teacher,\n        grade: newGrade[0].grade,\n        subGrade: newGrade[0].subGrade,\n        editModel:true\n      });\n    }\n  };\n  handleEditGrade=()=>{\n    const {\n      teacher,\n      grade,\n      subGrade,\n      students,\n      schoolYear,\n      editModel\n    } = this.state;\n\n    let newGrade={\n      grade:grade,\n      subGrade:subGrade,\n      teacher:teacher,\n      students:students,\n    }\n    if (parseInt(grade) > 0 && parseInt(grade) < 5) {\n      let grades = schoolYear.juniorSchool.filter(\n          grd => grd.grade !== grade\n      );\n     console.log(grades)\n    }\n    if (parseInt(grade) > 4 && parseInt(grade) < 8) {\n      let newGrade = schoolYear.interSchool.filter(\n          grd => grd.grade === grade && grd.subGrade === subGrade\n      );\n\n    }\n    if (parseInt(grade) > 7 && parseInt(grade) < 13) {\n      let newGrade = schoolYear.highSchool.filter(\n          grd => grd.grade === grade && grd.subGrade === subGrade\n      );\n\n    }\n  }\n  render() {\n    const {\n      yearFrom,\n      yearTo,\n      teacher,\n      grade,\n      subGrade,\n      students,\n      users,\n      addStudent,\n      filterByName,\n      search,\n      schoolYear,\n      editModel\n    } = this.state;\n    return (\n      <div className={YearCreate.year_container}>\n        <div className={YearCreate.year_title_border}>\n          <div className={YearCreate.year_create_title}>\n            Създаване на учебна година\n          </div>\n          <Year\n            yearFrom={yearFrom}\n            yearTo={yearTo}\n            handleInput={this.handleInput}\n          />\n        </div>\n        <div className={YearCreate.year_holder}>\n          <GradeListContainer\n            schoolYear={schoolYear}\n            handleEditGrade={this.handleTakeGrade}\n          />\n          <CreateGradeContainer\n            handleCreateGrade={this.handleCreateGrade}\n            yearFrom={yearFrom}\n            editModel={editModel}\n            yearTo={yearTo}\n            teacher={teacher}\n            grade={grade}\n            subGrade={subGrade}\n            students={students}\n            users={users}\n            addStudent={addStudent}\n            filterByName={filterByName}\n            search={search}\n            handleEditGrade={this.handleEditGrade}\n            handleDeleteStudent={this.handleDeleteStudent}\n            handleInput={this.handleInput}\n            handleAddStudent={this.handleAddStudent}\n            handleChangeFilter={this.handleChangeFilter}\n            handleSearch={this.handleSearch}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nYearCreateContainer.propTypes = {};\n\nexport default YearCreateContainer;\n"]},"metadata":{},"sourceType":"module"}