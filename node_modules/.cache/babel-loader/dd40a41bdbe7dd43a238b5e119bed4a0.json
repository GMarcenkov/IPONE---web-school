{"ast":null,"code":"var _jsxFileName = \"/home/george/Documents/Home/ipon-web-school/src/client/admin/modules/products/productCreate/ProductCreateContainer.js\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport \"./components/ProductCreate.css\";\nimport slugify from \"slugify\";\nimport Select from \"react-select\";\nimport { CustomOption } from \"../../category/components/CategoryCreate/CustomOption\";\nimport { selectCategory } from \"../../category/components/CategoryCreate/SelectCategory\";\n\nclass ProductCreateContainer extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleInput = event => {\n      this.setState({ ...this.state,\n        [event.target.name]: event.target.value\n      });\n    };\n\n    this.handleChangeParent = parent => {\n      this.setState({\n        category_title: parent.label\n      });\n    };\n\n    this.handleGetCategory = async () => {\n      await axios.get(\"http://localhost:5000/category/\").then(response => {\n        response.data.map(category => {\n          this.handleBuildCategory(category, response.data);\n        });\n        this.state.subcategories.map(sub => {\n          if (!sub.parent_id) {\n            this.state.categories.push(sub);\n          }\n        });\n        this.setState({\n          isLoading: false\n        });\n      }).catch(function (error) {});\n    };\n\n    this.handleBuildCategory = (category, categories) => {\n      let result = categories.filter(sub => sub.parent_id === category._id);\n\n      if (result.length > 0) {\n        category.subcategory = result;\n        this.state.subcategories.push(category);\n      } else {\n        if (!category.parent_id) {\n          this.state.subcategories.push(category);\n        }\n      }\n    };\n\n    this.validateForm = data => {\n      const error = {};\n\n      if (data.title.length < 3) {\n        error.title = \"Името е твърде късо.\";\n      }\n\n      if (data.price < 1) {\n        error.price = \"Липсва цена.\";\n      }\n\n      if (data.category_title.length < 3) {\n        error.category = \"Изберете категория.\";\n      }\n\n      if (data.weight < 1) {\n        error.weight = \"Добавете тегло.\";\n      }\n\n      if (data.sku < 1) {\n        error.sku = \"Добавете SKU.\";\n      }\n\n      if (data.quantity < 1) {\n        error.quantity = \"Добавете бройка.\";\n      }\n\n      if (data.imageLink < 1) {\n        error.imageLink = \"Добавете снимка.\";\n      }\n\n      return error;\n    };\n\n    this.handleSubmit = () => {\n      const {\n        title,\n        years,\n        students,\n        teacher,\n        quantity\n      } = this.state;\n      const errors = this.validateForm(this.state);\n      const isValid = Object.values(errors).filter(Boolean).length <= 0;\n\n      if (!isValid) {\n        this.setState({\n          errors: errors\n        });\n        return;\n      }\n\n      this.setState({\n        request: \"\"\n      });\n      const subject = {\n        title: title,\n        years: years,\n        students: students,\n        teacher: teacher,\n        quantity: quantity,\n        slug: slugify(title, {\n          lower: true,\n          remove: /[():.@><,_{}]/g\n        })\n      };\n      axios.post(\"http://localhost:5000/products/add\", subject).then(res => this.setState({\n        title: \"\",\n        years: 0,\n        students: [],\n        teacher: \"\",\n        quantity: 0\n      })).catch(error => this.setState({\n        error: \"Името или SKU на пеодукта е вече използвано.\"\n      }));\n    };\n\n    this.state = {\n      title: \"\",\n      years: '',\n      teacher: \"\",\n      quantity: 0,\n      students: [],\n      categories: [],\n      subcategories: [],\n      isLoading: true,\n      errors: {},\n      error: \"\"\n    };\n  }\n\n  componentDidMount() {\n    this.handleGetCategory();\n  }\n\n  render() {\n    const {\n      title,\n      discount_price,\n      sku,\n      quantity,\n      errors\n    } = this.state;\n    return React.createElement(\"div\", {\n      className: \"create_product\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form_row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, \" \", React.createElement(\"div\", {\n      className: \"form_body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, \"\\u041D\\u0430\\u0438\\u043C\\u0435\\u043D\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043D\\u0430 \\u043F\\u0440\\u0435\\u0434\\u043C\\u0435\\u0442\\u0430\"), React.createElement(\"input\", {\n      className: \"form_input\",\n      name: \"title\",\n      type: \"text\",\n      onChange: this.handleInput,\n      value: title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, errors.category ? errors.category : \"\"))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, \" \", React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, \"\\u0423\\u0447\\u0438\\u0442\\u0435\\u043B\"), React.createElement(\"input\", {\n      className: \"form_input\",\n      name: \"discount_price\",\n      type: \"text\",\n      onChange: this.handleInput,\n      value: discount_price,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, errors.discount_price ? errors.discount_price : \"\")))), React.createElement(\"div\", {\n      className: \"form_row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form_body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, \"\\u0413\\u043E\\u0434\\u0438\\u043D\\u0430 \\u043D\\u0430 \\u043E\\u0431\\u0443\\u0447\\u0435\\u043D\\u0438\\u0435\"), React.createElement(\"input\", {\n      className: \"form_input\",\n      name: \"sku\",\n      type: \"text\",\n      onChange: this.handleInput,\n      value: sku,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, errors.sku ? errors.sku : \"\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, \"\\u0411\\u0440\\u043E\\u0439\\u043A\\u0430\"), React.createElement(\"input\", {\n      className: \"form_input\",\n      placeholder: \"\\u0411\\u0440\\u043E\\u0439\\u043A\\u0430\",\n      name: \"quantity\",\n      type: \"number\",\n      onChange: this.handleInput,\n      value: quantity,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, errors.quantity ? errors.quantity : \"\")))), React.createElement(\"button\", {\n      className: \"create_button\",\n      onClick: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, \"\\u0421\\u044A\\u0437\\u0434\\u0430\\u0439\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, this.state.error));\n  }\n\n}\n\nProductCreateContainer.propTypes = {};\nexport default ProductCreateContainer;","map":{"version":3,"sources":["/home/george/Documents/Home/ipon-web-school/src/client/admin/modules/products/productCreate/ProductCreateContainer.js"],"names":["React","axios","slugify","Select","CustomOption","selectCategory","ProductCreateContainer","Component","constructor","props","handleInput","event","setState","state","target","name","value","handleChangeParent","parent","category_title","label","handleGetCategory","get","then","response","data","map","category","handleBuildCategory","subcategories","sub","parent_id","categories","push","isLoading","catch","error","result","filter","_id","length","subcategory","validateForm","title","price","weight","sku","quantity","imageLink","handleSubmit","years","students","teacher","errors","isValid","Object","values","Boolean","request","subject","slug","lower","remove","post","res","componentDidMount","render","discount_price","color","propTypes"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\nimport \"./components/ProductCreate.css\";\nimport slugify from \"slugify\";\nimport Select from \"react-select\";\nimport {CustomOption} from \"../../category/components/CategoryCreate/CustomOption\";\nimport {selectCategory} from \"../../category/components/CategoryCreate/SelectCategory\";\n\nclass ProductCreateContainer extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      title: \"\",\n      years:'',\n      teacher: \"\",\n      quantity: 0,\n      students: [],\n      categories: [],\n      subcategories:[],\n      isLoading:true,\n      errors: {},\n      error: \"\",\n    };\n  }\n\n  componentDidMount() {\n    this.handleGetCategory()\n  }\n\n  handleInput = event => {\n    this.setState({\n      ...this.state,\n      [event.target.name]: event.target.value\n    });\n  };\n\n  handleChangeParent = parent => {\n    this.setState({ category_title: parent.label });\n  };\n\n  handleGetCategory = async () => {\n    await axios\n        .get(\"http://localhost:5000/category/\")\n        .then(response => {\n          response.data.map(category => {\n            this.handleBuildCategory(category,response.data);\n          });\n          this.state.subcategories.map(sub => {\n            if (!sub.parent_id) {\n              this.state.categories.push(sub);\n            }\n          });\n          this.setState({ isLoading: false });\n        })\n        .catch(function(error) {});\n  };\n  handleBuildCategory = (category,categories) => {\n    let result = categories.filter(\n        sub => sub.parent_id === category._id\n    );\n\n    if (result.length > 0) {\n      category.subcategory = result;\n      this.state.subcategories.push(category);\n    } else {\n      if (!category.parent_id) {\n        this.state.subcategories.push(category);\n      }\n    }\n  };\n  validateForm = data => {\n    const error = {};\n\n    if (data.title.length < 3) {\n      error.title = \"Името е твърде късо.\";\n    }\n    if (data.price < 1) {\n      error.price = \"Липсва цена.\";\n    }\n    if (data.category_title.length < 3) {\n      error.category = \"Изберете категория.\";\n    }\n    if (data.weight < 1) {\n      error.weight = \"Добавете тегло.\";\n    }\n    if (data.sku < 1) {\n      error.sku = \"Добавете SKU.\";\n    }\n    if (data.quantity < 1) {\n      error.quantity = \"Добавете бройка.\";\n    }\n    if (data.imageLink < 1) {\n      error.imageLink = \"Добавете снимка.\";\n    }\n    return error;\n  };\n  handleSubmit = () => {\n    const {\n      title,\n      years,\n      students,\n      teacher,\n      quantity,\n    } = this.state;\n    const errors = this.validateForm(this.state);\n    const isValid = Object.values(errors).filter(Boolean).length <= 0;\n    if (!isValid) {\n      this.setState({ errors: errors });\n      return;\n    }\n    this.setState({ request: \"\" });\n    const subject = {\n      title: title,\n      years: years,\n      students: students,\n      teacher: teacher,\n      quantity: quantity,\n      slug: slugify(title, { lower: true, remove: /[():.@><,_{}]/g })\n    };\n    axios\n      .post(\"http://localhost:5000/products/add\", subject)\n      .then(res =>\n        this.setState({\n          title: \"\",\n          years: 0,\n          students: [],\n          teacher: \"\",\n          quantity: 0\n        })\n      )\n      .catch(error =>\n        this.setState({ error: \"Името или SKU на пеодукта е вече използвано.\" })\n      );\n  };\n  render() {\n    const {\n      title,\n      discount_price,\n      sku,\n      quantity,\n      errors\n    } = this.state;\n    return (\n      <div className=\"create_product\">\n\n        <div className=\"form_row\">\n          <div className=\"row\">\n            {\" \"}\n            <div className=\"form_body\">\n              <div>\n                <div>Наименование на предмета</div>\n                <input\n                    className=\"form_input\"\n                    name=\"title\"\n                    type=\"text\"\n                    onChange={this.handleInput}\n                    value={title}\n                />\n                <div style={{ color: \"red\" }}>\n                  {errors.category ? errors.category : \"\"}\n                </div>\n              </div>\n            </div>\n            <div>\n              {\" \"}\n              <div>Учител</div>\n              <input\n                className=\"form_input\"\n                name=\"discount_price\"\n                type=\"text\"\n                onChange={this.handleInput}\n                value={discount_price}\n              />\n              <div style={{ color: \"red\" }}>\n                {errors.discount_price ? errors.discount_price : \"\"}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"form_row\">\n          <div className=\"row\">\n            <div className=\"form_body\">\n              <div>Година на обучение</div>\n              <input\n                className=\"form_input\"\n                name=\"sku\"\n                type=\"text\"\n                onChange={this.handleInput}\n                value={sku}\n              />\n              <div style={{ color: \"red\" }}>{errors.sku ? errors.sku : \"\"}</div>\n            </div>\n            <div>\n              <div>Бройка</div>\n              <input\n                className=\"form_input\"\n                placeholder=\"Бройка\"\n                name=\"quantity\"\n                type=\"number\"\n                onChange={this.handleInput}\n                value={quantity}\n              />\n              <div style={{ color: \"red\" }}>\n                {errors.quantity ? errors.quantity : \"\"}\n              </div>\n            </div>\n            \n          </div>\n        </div>\n        <button className=\"create_button\" onClick={this.handleSubmit}>\n          Създай\n        </button>\n        <div>{this.state.error}</div>\n      </div>\n    );\n  }\n}\n\nProductCreateContainer.propTypes = {};\n\nexport default ProductCreateContainer;\n"]},"metadata":{},"sourceType":"module"}